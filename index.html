<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmaalWEB | By Owen Lee</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #05000a; --accent: #bc13fe; --text: #f0e6ff; --border: rgba(188, 19, 254, 0.2); --warning: #ff3333; --success: #00ff41; }
        body, html { margin: 0; padding: 0; height: 100%; background: var(--bg); color: var(--text); font-family: 'Outfit', sans-serif; overflow: hidden; }
        
        #header { background: #000; border-bottom: 1px solid var(--border); padding: 10px 15px; display: flex; align-items: center; gap: 10px; height: 50px; }
        input { flex: 1; background: #0a0015; border: 1px solid #331144; color: var(--accent); padding: 10px; font-family: 'Fira Code', monospace; outline: none; border-radius: 4px; transition: 0.3s; }
        button { background: transparent; border: 1px solid var(--accent); color: var(--accent); padding: 8px 16px; cursor: pointer; font-family: 'Fira Code'; border-radius: 4px; transition: 0.2s; }
        button:hover { background: var(--accent); color: white; }

        /* Bot Container and Bubble UNDER button */
        #bot-container { position: relative; display: inline-block; }
        .bot-bubble {
            position: absolute; 
            top: 135%; /* Positioned below the button */
            left: 50%; 
            transform: translateX(-50%) translateY(-10px);
            background: #0a0015; 
            border: 1px solid var(--success); 
            color: var(--success);
            padding: 6px 12px; 
            font-size: 11px; 
            white-space: nowrap; 
            border-radius: 6px;
            font-family: 'Fira Code', monospace; 
            box-shadow: 0 5px 15px rgba(0, 255, 65, 0.15);
            opacity: 0; 
            transition: opacity 0.3s ease, transform 0.3s ease; 
            pointer-events: none; 
            z-index: 10002;
        }
        /* Arrow pointing UP towards the button */
        .bot-bubble::after {
            content: ''; 
            position: absolute; 
            bottom: 100%; 
            left: 50%; 
            margin-left: -5px;
            border-width: 5px; 
            border-style: solid; 
            border-color: transparent transparent var(--success) transparent;
        }
        .show-bubble { opacity: 1; transform: translateX(-50%) translateY(0); }
        #bot-launcher { border-color: var(--success); color: var(--success); }

        #viewport { height: calc(100vh - 50px); width: 100%; position: relative; background: #fff; }
        iframe { width: 100%; height: 100%; border: none; }

        #loader { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #05000a; z-index: 9999; display: none; flex-direction: column; align-items: center; justify-content: center; }
        .term-box { width: 85%; max-width: 700px; height: 400px; padding: 20px; border: 1px solid var(--border); background: #000; overflow-y: scroll; scrollbar-width: none; }
        .line { font-family: 'Fira Code'; font-size: 13px; color: var(--accent); margin-bottom: 4px; }
        
        .home { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; background: radial-gradient(circle, #1a0530 0%, #05000a 100%); z-index: 10; }
        .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px; }
        .card { padding: 15px 30px; border: 1px solid var(--border); background: rgba(255,255,255,0.05); cursor: pointer; border-radius: 4px; text-align: center; }
        .card:hover { border-color: var(--accent); background: rgba(188, 19, 254, 0.1); }
    </style>
</head>
<body>

<div id="header">
    <button onclick="goHome()">Home</button>
    <button onclick="goBack()">Back</button>
    
    <div id="bot-container">
        <div id="botBubble" class="bot-bubble">...</div>
        <button id="bot-launcher" onclick="window.open('assistant.html', 'bot', 'width=450,height=650')">Open Bot</button>
    </div>

    <input type="text" id="urlInput" placeholder="Secure search..." onkeydown="if(event.key==='Enter') handleSurf()">
    <button onclick="handleSurf()">Go</button>
</div>

<div id="viewport">
    <div id="loader"><div class="term-box" id="termLog"></div></div>
    <div id="homeScreen" class="home">
        <h1 style="color:var(--accent); font-family:'Fira Code'; letter-spacing: 5px;">SmaalWEB | Owen Lee</h1>
        <div class="grid">
            <div class="card" onclick="launch('google.com')">Google</div>
            <div class="card" onclick="launch('itch.io')">Itch.io</div>
            <div class="card" onclick="launch('poki.com')">Poki</div>
            <div class="card" onclick="launch('crazygames.com')">Crazy Games</div>
            <div class="card" onclick="launch('freezenova.com')">FreezeNova</div>
            <div class="card" onclick="launch('quiz-90.live')">Quiz-90.live</div>
        </div>
    </div>
    <iframe id="proxyFrame" src="about:blank" style="display:none;"></iframe>
</div>

<script>
    const API_ENDPOINT = "https://smaalweb-api.imcrabfr.workers.dev/?url=";

    // --- AUTO-TYPER ---
    window.addEventListener('storage', (e) => {
        if (e.key === 'autoFillUrl' && e.newValue) {
            const targetUrl = e.newValue;
            const input = document.getElementById('urlInput');
            input.value = ""; input.focus();
            let i = 0;
            const typer = setInterval(() => {
                input.value += targetUrl[i]; i++;
                if (i >= targetUrl.length) {
                    clearInterval(typer);
                    setTimeout(() => launch(input.value), 500);
                }
            }, 70);
        }
    });

    // --- FREQUENT BOT QUOTES (Under Button) ---
    const botQuotes = [
        "Owen, let's play.", "Ready to bypass?", "Checking the mirrors...", 
        "Proxy looks stable.", "New games found!", "Waiting for command...", 
        "Systems nominal.", "Try typing 'Poki'!", "Accessing game hubs...", "Slimy's online.",
        "Still here!.", "ask me abt some games!.", "sadly ppl call me gay and shi :(.", "i like long walks on the beach.", "did u kno im named after a typo?",
        "im nto a real ai tbh.", "owo whats this?", "beep boop.", "i can do the thing.", "press the button above me!", "im lonely :(", "owen trapped me in here, helpðŸ™"
    ];

    function triggerBotShout() {
        const bubble = document.getElementById('botBubble');
        bubble.innerText = "...";
        bubble.classList.add('show-bubble');

        setTimeout(() => {
            bubble.innerText = botQuotes[Math.floor(Math.random() * botQuotes.length)];
            setTimeout(() => {
                bubble.classList.remove('show-bubble');
                const nextDelay = Math.floor(Math.random() * 3000) + 5000;
                setTimeout(triggerBotShout, nextDelay);
            }, 3500);
        }, 1000);
    }

    setTimeout(triggerBotShout, 3000);

    async function launch(input) {
        if(!input) return;
        localStorage.removeItem('autoFillUrl');
        const loader = document.getElementById('loader');
        const frame = document.getElementById('proxyFrame');
        const home = document.getElementById('homeScreen');
        const log = document.getElementById('termLog');
        
        let targetUrl = input.trim();
        if (!targetUrl.includes('.')) targetUrl = "https://www.google.com/search?q=" + encodeURIComponent(targetUrl);
        else if (!targetUrl.startsWith('http')) targetUrl = 'https://' + targetUrl;

        loader.style.display = 'flex';
        log.innerHTML = `<div class="line">> Establishing Smaal-Node Uplink...</div>`;
        await new Promise(r => setTimeout(r, 800));

        frame.src = API_ENDPOINT + encodeURIComponent(targetUrl);
        frame.style.display = 'block'; home.style.display = 'none'; loader.style.display = 'none';
    }

    function handleSurf() { launch(document.getElementById('urlInput').value); }
    function goHome() { location.reload(); }
    function goBack() { document.getElementById('proxyFrame').contentWindow.history.back(); }
</script>
</body>
</html>